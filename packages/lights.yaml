automation:
  - alias: Update global brightness when settings change
    trigger:
      - platform: state
        entity_id: input_number.morning_brightness
      - platform: state
        entity_id: input_number.day_brightness
      - platform: state
        entity_id: input_number.afternoon_brightness
      - platform: state
        entity_id: input_number.early_evening_brightness
      - platform: state
        entity_id: input_number.evening_brightness
      - platform: state
        entity_id: input_number.night_brightness
    action:
      - service: homeassistant.update_entity
        data:
          entity_id: sensor.global_brightness

  - alias: Toggle Kitchen worktop light through wall button press
    trigger:
      - platform: mqtt
        topic: zigbee2mqtt/kitchen_wall_switch
    condition:
      - condition: template
        value_template: "{{ trigger.payload_json.click == 'right' }}"
    action:
      - service: light.toggle
        data:
          entity_id: light.kitchen_worktop

  - alias: Toggle Living Room pendant through wall button press
    trigger:
      - platform: mqtt
        topic: zigbee2mqtt/living_room_wall_switch
    condition:
      - condition: template
        value_template: "{{ trigger.payload_json.click == 'left' }}"
    action:
      - service: light.toggle
        data:
          entity_id: light.living_room_pendant

input_number:
  morning_brightness:
    icon: mdi:tune
    max: 100
    min: 0
    name: Morning brightness
    step: 1
    unit_of_measurement: "%"
  day_brightness:
    icon: mdi:tune
    max: 100
    min: 0
    name: Day brightness
    step: 1
    unit_of_measurement: "%"
  afternoon_brightness:
    icon: mdi:tune
    max: 100
    min: 0
    name: Afternoon brightness
    step: 1
    unit_of_measurement: "%"
  early_evening_brightness:
    icon: mdi:tune
    max: 100
    min: 0
    name: Early evening brightness
    step: 1
    unit_of_measurement: "%"
  evening_brightness:
    icon: mdi:tune
    max: 100
    min: 0
    name: Evening brightness
    step: 1
    unit_of_measurement: "%"
  night_brightness:
    icon: mdi:tune
    max: 100
    min: 0
    name: Night brightness
    step: 1
    unit_of_measurement: "%"

light:
  - platform: switch
    name: Kitchen mood lighting
    entity_id: switch.power_outlet_1
  - platform: switch
    name: Living Room pendant
    entity_id: switch.power_outlet_2

sensor:
  - platform: template
    sensors:
      global_brightness:
        friendly_name: Brightness
        icon_template: mdi:brightness-6
        value_template: >-
          {% set currentScene = states('input_select.scene')|lower|replace(' ', '_') %}
          {% set settingEntity = "input_number.%s_brightness"|format(currentScene) %}
          {{ ((states(settingEntity)|int / 100) * 255)|int }}
